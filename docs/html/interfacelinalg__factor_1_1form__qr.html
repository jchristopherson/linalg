<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>linalg: linalg_factor::form_qr Interface Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">linalg
   &#160;<span id="projectnumber">1.4.3</span>
   </div>
   <div id="projectbrief">A linear algebra library that provides a user-friendly interface to several BLAS and LAPACK routines.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('interfacelinalg__factor_1_1form__qr.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="interfacelinalg__factor_1_1form__qr-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">linalg_factor::form_qr Interface Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Forms the full M-by-M orthogonal matrix Q from the elementary reflectors returned by the base QR factorization algorithm.  
 <a href="interfacelinalg__factor_1_1form__qr.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a97be7870c00c593ade37d8ff45125b95"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacelinalg__factor_1_1form__qr.html#a97be7870c00c593ade37d8ff45125b95">form_qr_no_pivot</a> (r, tau, q, work, olwork, err)</td></tr>
<tr class="memdesc:a97be7870c00c593ade37d8ff45125b95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forms the full M-by-M orthogonal matrix Q from the elementary reflectors returned by the base QR factorization algorithm.  <a href="#a97be7870c00c593ade37d8ff45125b95">More...</a><br /></td></tr>
<tr class="separator:a97be7870c00c593ade37d8ff45125b95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad30a1f013145113ab7d57913501f1163"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacelinalg__factor_1_1form__qr.html#ad30a1f013145113ab7d57913501f1163">form_qr_pivot</a> (r, tau, pvt, q, p, work, olwork, err)</td></tr>
<tr class="memdesc:ad30a1f013145113ab7d57913501f1163"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forms the full M-by-M orthogonal matrix Q from the elementary reflectors returned by the base QR factorization algorithm.  <a href="#ad30a1f013145113ab7d57913501f1163">More...</a><br /></td></tr>
<tr class="separator:ad30a1f013145113ab7d57913501f1163"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Forms the full M-by-M orthogonal matrix Q from the elementary reflectors returned by the base QR factorization algorithm. </p>
<dl class="section user"><dt>Usage</dt><dd>The following example illustrates how to explicitly form the Q and R matrices from the output of <a class="el" href="interfacelinalg__factor_1_1qr__factor.html" title="Computes the QR factorization of an M-by-N matrix. ">qr_factor</a>, and then use the resulting matrices to solve a system of linear equations. <div class="fragment"><div class="line"><span class="keyword">program</span> example</div><div class="line">    <span class="keywordtype">use </span>iso_fortran_env, <span class="keywordtype">only</span> : real64, int32</div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacelinalg__factor.html">linalg_factor</a>, <span class="keywordtype">only</span> : <a class="code" href="interfacelinalg__factor_1_1qr__factor.html">qr_factor</a>, <a class="code" href="interfacelinalg__factor_1_1form__qr.html">form_qr</a></div><div class="line">    <span class="keywordtype">use </span><a class="code" href="namespacelinalg__solve.html">linalg_solve</a>, <span class="keywordtype">only</span> : <a class="code" href="interfacelinalg__solve_1_1solve__triangular__system.html">solve_triangular_system</a></div><div class="line">    <span class="keywordtype">implicit none</span></div><div class="line"></div><div class="line">    <span class="comment">! Variables</span></div><div class="line">    <span class="keywordtype">real(real64)</span> :: a(3,3), b(3), q(3,3), tau(3)</div><div class="line">    <span class="keywordtype">integer(int32)</span> :: i</div><div class="line"></div><div class="line">    <span class="comment">! Build the 3-by-3 matrix A.</span></div><div class="line">    <span class="comment">!     | 1   2   3 |</span></div><div class="line">    <span class="comment">! A = | 4   5   6 |</span></div><div class="line">    <span class="comment">!     | 7   8   0 |</span></div><div class="line">    a = reshape( &amp;</div><div class="line">        [1.0d0, 4.0d0, 7.0d0, 2.0d0, 5.0d0, 8.0d0, 3.0d0, 6.0d0, 0.0d0], &amp;</div><div class="line">        [3, 3])</div><div class="line"></div><div class="line">    <span class="comment">! Build the right-hand-side vector B.</span></div><div class="line">    <span class="comment">!     | -1 |</span></div><div class="line">    <span class="comment">! b = | -2 |</span></div><div class="line">    <span class="comment">!     | -3 |</span></div><div class="line">    b = [-1.0d0, -2.0d0, -3.0d0]</div><div class="line"></div><div class="line">    <span class="comment">! The solution is:</span></div><div class="line">    <span class="comment">!     |  1/3 |</span></div><div class="line">    <span class="comment">! x = | -2/3 |</span></div><div class="line">    <span class="comment">!     |   0  |</span></div><div class="line"></div><div class="line">    <span class="comment">! Compute the QR factorization without column pivoting</span></div><div class="line">    <span class="keyword">call </span><a class="code" href="interfacelinalg__factor_1_1qr__factor.html">qr_factor</a>(a, tau)</div><div class="line"></div><div class="line">    <span class="comment">! Build Q and R.  A is overwritten with R</span></div><div class="line">    <span class="keyword">call </span><a class="code" href="interfacelinalg__factor_1_1form__qr.html">form_qr</a>(a, tau, q)</div><div class="line"></div><div class="line">    <span class="comment">! As this system is square, matrix R is upper triangular.  Also, Q is</span></div><div class="line">    <span class="comment">! always orthogonal such that it&#39;s inverse and transpose are equal.  As the</span></div><div class="line">    <span class="comment">! system is now factored, its form is: Q * R * X = B.  Solving this system</span></div><div class="line">    <span class="comment">! is then as simple as solving the upper triangular system: </span></div><div class="line">    <span class="comment">! R * X = Q**T * B.</span></div><div class="line"></div><div class="line">    <span class="comment">! Compute Q**T * B, and store the results in B</span></div><div class="line">    b = matmul(transpose(q), b)</div><div class="line"></div><div class="line">    <span class="comment">! Solve the upper triangular system R * X = Q**T * B for X</span></div><div class="line">    <span class="keyword">call </span><a class="code" href="interfacelinalg__solve_1_1solve__triangular__system.html">solve_triangular_system</a>(.true., .false., .true., a, b)</div><div class="line"></div><div class="line">    <span class="comment">! Display the results</span></div><div class="line">    print <span class="stringliteral">&#39;(A)&#39;</span>, <span class="stringliteral">&quot;QR Solution: X = &quot;</span></div><div class="line">    print <span class="stringliteral">&#39;(F8.4)&#39;</span>, (b(i), i = 1, <span class="keyword">size</span>(b))</div><div class="line"></div><div class="line">    <span class="comment">! Notice, QR factorization with column pivoting could be accomplished via</span></div><div class="line">    <span class="comment">! a similar approach, but the column pivoting would need to be accounted</span></div><div class="line">    <span class="comment">! for by noting that Q * R = A * P, where P is an N-by-N matrix describing</span></div><div class="line">    <span class="comment">! the column pivoting operations.</span></div><div class="line"><span class="keyword">end program</span></div></div><!-- fragment --> The above program produces the following output. <div class="fragment"><div class="line">QR Solution: X =</div><div class="line">0.3333</div><div class="line">-0.6667</div><div class="line">0.0000</div></div><!-- fragment --></dd></dl>
<dl class="section user"><dt>See Also</dt><dd><ul>
<li><a href="https://en.wikipedia.org/wiki/QR_decomposition">Wikipedia</a></li>
<li><a href="http://netlib.org/lapack/lug/node39.html">LAPACK Users Manual</a> </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg__factor_8f90_source.html#l00245">245</a> of file <a class="el" href="linalg__factor_8f90_source.html">linalg_factor.f90</a>.</p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a id="a97be7870c00c593ade37d8ff45125b95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97be7870c00c593ade37d8ff45125b95">&#9670;&nbsp;</a></span>form_qr_no_pivot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine linalg_factor::form_qr::form_qr_no_pivot </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out), optional, target&#160;</td>
          <td class="paramname"><em>work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), intent(out), optional&#160;</td>
          <td class="paramname"><em>olwork</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Forms the full M-by-M orthogonal matrix Q from the elementary reflectors returned by the base QR factorization algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r</td><td>On input, an M-by-N matrix where the elements below the diagonal contain the elementary reflectors generated from the QR factorization. On and above the diagonal, the matrix contains the matrix R. On output, the elements below the diagonal are zeroed such that the remaining matrix is simply the M-by-N matrix R. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tau</td><td>A MIN(M, N)-element array containing the scalar factors of each elementary reflector defined in <code>r</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">q</td><td>An M-by-M matrix where the full orthogonal matrix Q will be written. In the event that M &gt; N, Q may be supplied as M-by-N, and therefore only return the useful submatrix Q1 (Q = [Q1, Q2]) as the factorization can be written as Q * R = [Q1, Q2] * [R1; 0]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">work</td><td>An optional input, that if provided, prevents any local memory allocation. If not provided, the memory required is allocated within. If provided, the length of the array must be at least <code>olwork</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">olwork</td><td>An optional output used to determine workspace size. If supplied, the routine determines the optimal size for <code>work</code>, and returns without performing any actual calculations. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>LA_ARRAY_SIZE_ERROR: Occurs if any of the input arrays are not sized appropriately.</li>
<li>LA_OUT_OF_MEMORY_ERROR: Occurs if local memory must be allocated, and there is insufficient memory available.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Notes</dt><dd>This routine utilizes the LAPACK routine DORGQR. </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg__factor_8f90_source.html#l00882">882</a> of file <a class="el" href="linalg__factor_8f90_source.html">linalg_factor.f90</a>.</p>

</div>
</div>
<a id="ad30a1f013145113ab7d57913501f1163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad30a1f013145113ab7d57913501f1163">&#9670;&nbsp;</a></span>form_qr_pivot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine linalg_factor::form_qr::form_qr_pivot </td>
          <td>(</td>
          <td class="paramtype">real(real64), dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>pvt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(real64), dimension(:), intent(out), optional, target&#160;</td>
          <td class="paramname"><em>work</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(int32), intent(out), optional&#160;</td>
          <td class="paramname"><em>olwork</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">class(errors), intent(inout), optional, target&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Forms the full M-by-M orthogonal matrix Q from the elementary reflectors returned by the base QR factorization algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">r</td><td>On input, an M-by-N matrix where the elements below the diagonal contain the elementary reflectors generated from the QR factorization. On and above the diagonal, the matrix contains the matrix R. On output, the elements below the diagonal are zeroed such that the remaining matrix is simply the M-by-N matrix R. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tau</td><td>A MIN(M, N)-element array containing the scalar factors of each elementary reflector defined in <code>r</code>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pvt</td><td>An N-element column pivot array as returned by the QR factorization. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">q</td><td>An M-by-M matrix where the full orthogonal matrix Q will be written. In the event that M &gt; N, Q may be supplied as M-by-N, and therefore only return the useful submatrix Q1 (Q = [Q1, Q2]) as the factorization can be written as Q * R = [Q1, Q2] * [R1; 0]. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p</td><td>An N-by-N matrix where the pivot matrix will be written. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">work</td><td>An optional input, that if provided, prevents any local memory allocation. If not provided, the memory required is allocated within. If provided, the length of the array must be at least <code>olwork</code>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">olwork</td><td>An optional output used to determine workspace size. If supplied, the routine determines the optimal size for <code>work</code>, and returns without performing any actual calculations. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>An optional errors-based object that if provided can be used to retrieve information relating to any errors encountered during execution. If not provided, a default implementation of the errors class is used internally to provide error handling. Possible errors and warning messages that may be encountered are as follows.<ul>
<li>LA_ARRAY_SIZE_ERROR: Occurs if any of the input arrays are not sized appropriately.</li>
<li>LA_OUT_OF_MEMORY_ERROR: Occurs if local memory must be allocated, and there is insufficient memory available.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Notes</dt><dd>This routine utilizes the LAPACK routine DORGQR. </dd></dl>

<p class="definition">Definition at line <a class="el" href="linalg__factor_8f90_source.html#l01013">1013</a> of file <a class="el" href="linalg__factor_8f90_source.html">linalg_factor.f90</a>.</p>

</div>
</div>
<hr/>The documentation for this interface was generated from the following file:<ul>
<li>D:/Projects/Code/linalg/src/<a class="el" href="linalg__factor_8f90_source.html">linalg_factor.f90</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacelinalg__factor.html">linalg_factor</a></li><li class="navelem"><a class="el" href="interfacelinalg__factor_1_1form__qr.html">form_qr</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
